# 測試指南

## 🚀 快速測試

### 1. 網頁載入測試

打開瀏覽器開發者工具 (F12)，查看控制台訊息：

**成功情況**：
```
📦 Clerk SDK 載入完成
✅ Clerk SDK 載入成功  
🔧 Clerk Publishable Key 已設置
✅ Clerk 身份驗證系統初始化完成
```

**失敗情況**：
```
❌ Clerk SDK 載入失敗
❌ 未設置 Clerk Publishable Key
❌ Clerk 初始化失敗，無法繼續
```

### 2. 登入頁面測試

系統應該顯示：
- ✅ 全白背景的登入頁面
- ✅ 苗栗物資管理平台的品牌標識
- ✅ Clerk 登入/註冊區域（如果 Clerk 配置正確）
- ✅ 適當的錯誤訊息（如果 Clerk 配置有問題）

### 3. 身份驗證測試

使用有效的 Clerk 帳戶登入：
- ✅ 進入主應用程式
- ✅ 右上角顯示用戶按鈕
- ✅ 根據角色顯示適當的功能按鈕

## 🔧 除錯指引

### 檢查清單

1. **檢查 .env 檔案**
   ```bash
   # 檢查檔案是否存在
   ls -la .env
   
   # 檢查內容
   cat .env
   ```

2. **檢查 Clerk Publishable Key**
   - 確認 Key 格式正確（以 `pk_test_` 或 `pk_live_` 開頭）
   - 確認沒有多餘的空格或換行
   - 確認 Key 來自正確的 Clerk 專案

3. **檢查網路連線**
   ```bash
   # 測試 Clerk CDN 連線
   curl -I https://unpkg.com/@clerk/clerk-js@latest/dist/clerk.browser.js
   ```

4. **檢查瀏覽器控制台**
   - 查看是否有 JavaScript 錯誤
   - 查看網路面板是否有載入失敗的資源

### 常見問題解決

**Q: 頁面一直顯示載入中？**

A: 檢查：
- 網路連線是否正常
- Clerk CDN 是否可以訪問
- 瀏覽器是否阻擋了第三方腳本
- Clerk Publishable Key 是否正確設置

**Q: .env 檔案修改後沒有生效？**

A: 
- 執行 `npm run setup` 重新生成配置
- 清除瀏覽器快取
- 重新啟動開發服務器

**Q: Clerk 登入介面無法顯示？**

A: 檢查：
- 控制台是否有 Clerk 相關錯誤
- Publishable Key 是否有效
- Clerk Dashboard 中的應用配置是否正確

## 📊 效能測試

### 載入時間測試

在瀏覽器開發者工具的 Network 面板中：

1. **Clerk 載入成功**：
   - Clerk SDK 載入時間 < 2 秒
   - 用戶看到登入介面時間 < 3 秒

2. **Clerk 載入失敗**：
   - 系統顯示錯誤訊息時間 < 1 秒
   - 不會無限載入或白屏

### 功能測試清單

- [ ] 頁面正常載入
- [ ] Clerk 登入介面顯示（如果配置正確）
- [ ] 適當的錯誤處理（如果配置有問題）
- [ ] 成功登入後進入主應用
- [ ] 用戶按鈕正常顯示（右上角）
- [ ] 各項功能按鈕依角色權限顯示
- [ ] 庫存管理功能正常
- [ ] 資料持久化正常（localStorage）

## 🔐 安全性測試

### 環境變數安全性

1. **檢查 .env 檔案不被版本控制追蹤**：
   ```bash
   git status
   # .env 不應該出現在未追蹤檔案列表中
   ```

2. **檢查瀏覽器中無法直接訪問 .env**：
   - 開啟 `http://localhost:8000/.env`
   - 應該看到 404 錯誤或拒絕訪問

3. **檢查 Publishable Key 不在原始碼中**：
   ```bash
   grep -r "pk_test_" assets/js/ --exclude-dir=node_modules
   # 不應該有硬編碼的 Key
   ```

## 📱 響應式測試

### 手機版測試

1. 開啟瀏覽器開發者工具
2. 切換到手機視圖模式
3. 測試：
   - [ ] 登入頁面在手機上正常顯示
   - [ ] 按鈕大小適合觸控
   - [ ] 文字大小適合閱讀
   - [ ] 主應用程式響應式布局正常

### 平板版測試

1. 切換到平板視圖模式
2. 測試：
   - [ ] 界面元素適當縮放
   - [ ] 導航欄布局正常
   - [ ] 表格/卡片切換正常

## 🚨 錯誤處理測試

### 模擬網路錯誤

1. 在開發者工具中禁用網路
2. 重新載入頁面
3. 檢查：
   - [ ] 系統顯示適當的錯誤訊息
   - [ ] 不會無限載入或崩潰
   - [ ] 提供明確的解決建議

### 模擬 Clerk 配置錯誤

1. 在 `.env` 中設定無效的 Key
2. 執行 `npm run setup`
3. 重新載入頁面
4. 檢查：
   - [ ] 系統顯示配置錯誤訊息
   - [ ] 提供設置指南連結
   - [ ] 不會出現白屏或崩潰

---

**重要**: 此系統現在完全依賴 Clerk 身份驗證服務。請確保：
1. 正確設置 Clerk Publishable Key
2. 網路連線正常
3. 遵循 [CLERK_SETUP.md](./CLERK_SETUP.md) 中的設置指南